import 'package:flutter/material.dart';

void main() {
  runApp(const MyApp());
}

class MyApp extends StatefulWidget {
  const MyApp({Key? key}) : super(key: key);

  @override
  State<MyApp> createState() => _MyAppState();
}

class _MyAppState extends State<MyApp> {
  final numPessoas = TextEditingController();
  final numTotal = TextEditingController();
  final numComissao = TextEditingController();
  var textoPrecoFinal = "";
  var textoComissao = "";
  var textoConta = "";

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
        home: Scaffold(
            appBar: AppBar(title: const Text("Aplicativo divide conta")), body: Body()));
  }

  Body() {
    return Column(children: [
      TextFormField(
          controller: numPessoas,
          keyboardType: TextInputType.number,
          decoration: const InputDecoration(labelText: "Número de pessoas")),
      TextFormField(
          controller: numComissao,
          keyboardType: TextInputType.number,
          decoration: const InputDecoration(labelText: "Porcentagem da comissão de serviço")),
      TextFormField(
          controller: numTotal,
          keyboardType: TextInputType.number,
          decoration: const InputDecoration(labelText: "Total da conta")),
      ElevatedButton(onPressed: dividirConta, child: const Text("Dividir conta")),
      Text(textoConta),
      Text(textoPrecoFinal),
      Text(textoComissao)
    ]);
  }

  dividirConta() {
    double pessoas, conta, porcentagemComissao = 0, precoComissao, precoFinal;

    setState(() {
      pessoas = double.parse(numPessoas.text);
      conta = double.parse(numTotal.text);
      porcentagemComissao = double.parse(numComissao.text) / 100;

      if (pessoas <= 0 || conta < 0 || porcentagemComissao > 1 || porcentagemComissao < 0) {
        textoPrecoFinal = "ERRO: Valores inválidos";
        textoComissao = "";
        textoConta = "";
      } else {
        precoComissao = porcentagemComissao * conta;
        conta = precoComissao + conta;
        precoFinal = conta / pessoas;

        textoConta = "CONTA: R\$${conta.toStringAsFixed(2)}";
        textoPrecoFinal ="VALOR PARA CADA PESSOA: R\$${precoFinal.toStringAsFixed(2)} x ${pessoas.toStringAsFixed(0)} pessoas";
        textoComissao = "VALOR DA COMISSÃO: R\$${precoComissao.toStringAsFixed(2)}";
      }
    });
  }
}
